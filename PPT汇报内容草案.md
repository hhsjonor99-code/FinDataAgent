# 结课项目汇报PPT草案

## 封面展示：FinDataAgent
**基于 DeepSeek 的金融数据分析智能体**

### 团队成员与分工 (Team Roles)
*   **敏捷教练 (Agile Coach) / 代理 PO (Proxy Product Owner)**————yyh
    *   职责：负责把握产品愿景，管理 Backlog 优先级，主持 Sprint 评审与回顾，确保团队敏捷流程的顺畅运转。
*   **核心开发者 (Lead Developer)**————hyf
    *   职责：负责后端架构设计，实现核心逻辑（执行、沙箱、容错），以及前端 Streamlit 界面的构建。
*   **提示词工程师 (Prompt Engineer)**————jyt
    *   职责：负责设计与优化 System Prompt，构建 Tushare 知识库 Schema，调试 DeepSeek 的指令跟随能力与自我纠错逻辑。

## 1. 用户故事 (User Story)
### 1.1 典型用户画像
*   **角色**：金融学专业学生 / 初级量化分析师 / 个人投资者
*   **场景**：
    > "小明是一名金融系大三学生，他需要分析'贵州茅台'过去三年的股价波动率，并与大盘指数进行对比。"
    > "老王是一个经验丰富的金融分析师，他希望能快速验证自己的想法，比如：'如果我在2023年1月1日购买了贵州茅台，到2023年3月31日卖出，我能获得多少利润？'"
*   **现状**：
    *   **Excel**：手动下载 CSV，清洗数据繁琐，处理几十万行数据卡顿。
    *   **Python**：尝试学习编程，但被环境配置等困难劝退。
    *   **通用 AI**：询问大语言模型，它给出的结果通常是代码片段，需要用户手动调试。如果直接向其询问复杂的分析任务，模型往往无法理解用户需求，或者给出的结果包含大量幻觉

### 1.2 用户痛点 (Pain Points)
1.  **技术门槛高**：具备金融逻辑，但缺乏将逻辑转化为代码（Python/Pandas）的能力。
2.  **工具断层**：
    *   **Excel**：可视化操作简单但功能有限，难以自动化。
    *   **专业终端 (Wind)**：功能强大但昂贵，且难以进行自定义的二次开发分析。
3.  **交互效率低**：传统编程需要查文档、写代码、调试报错，耗时极长。

### 1.3 市面产品分析 (Market Analysis)
| 产品类型 | 代表产品 | 优势 | 劣势 |
| :--- | :--- | :--- | :--- |
| **传统金融终端** | Wind, 同花顺 | 数据全，功能强 | 价格昂贵，界面复杂，非自然语言交互 |
| **通用大模型** | ChatGPT, 文心一言 | 语言理解强 | **无法连接本地数据**，生成的代码容易产生幻觉（API 参数错误），无法闭环执行 |


### 1.4 项目需求分析 (Requirements)
*   **核心目标**：打造一个 **"懂金融的数据分析师助手"**。
*   **关键需求 (MVP)**：
    1.  **自然语言交互**：用户说人话，机器写代码。
    2.  **全自动闭环**：AI 负责 `思考 -> 查文档 -> 写代码 -> 运行 -> 改错 -> 出图` 的全流程。
    3.  **本地数据安全**：基于 Tushare 本地接口，数据不上传第三方云端。
    4.  **可视化直出**：直接在界面展示分析图表，而非仅返回文本。

## 2. 项目demo（MVP）展示

*   展示项目的核心功能：自然语言交互、全自动闭环、本地数据安全、可视化直出。
*   模型切换功能
*   用户个性化设置功能

## 3. 项目架构以及开发过程

### 3.1 最终交付的技术栈与Agent工作流概览
#### 3.1.1 技术栈
*   基于 Streamlit 构建的用户交互界面。
*   基于uv的项目依赖管理。
*   基于Tushare的数据接口。
*   基于OpenAI SDK的DeepSeek-V3模型调用。
*   基于Matplotlib,pandas,OpenPyXL等经典数据分析库进行数据分析。
#### 3.1.2 Agent架构图与工作流

    图一与图二（图一为Agent架构图，图二为工作流图）

### 3.2 项目迭代与优化过程（展示主要迭代内容）
#### 3.2.1 initial————sprint0
*   完成项目基本架构设计，采用"Intent Classification + Slot Filling" 模式
*   跑通“最小用例”：“查询贵州茅台2023年1月1日至2023年3月31日的股价”
*   目前使用硬编码进行意图分析

配图：图三（Intent Classification+Slot Filling）模式

#### 3.2.2 使用LLM进行意图分析————sprint1
*   基于LLM模型，对用户输入进行意图分类
*   基于提取出的参数，使用LLM进行代码生成

#### 3.2.3 实现关键重构————sprint2

##### 3.2.3.1 重构背景
基于前两给sprint的迭代，我们发现目前的架构如果继续往下推进，会有以下问题： 
* 开发维护成本高: 每增加一个新功能，开发者都必须手动写一个新的 Python 函数，并在 Prompt 里定义它的参数 Schema。这导致开发速度赶不上用户的需求变化。   
* 无法处理组合逻辑: 很难处理“用 A 结果去算 B，再用 B 结果去画 C”这种多步依赖的任务。AI 往往只能一次调用一个工具，无法形成复杂的业务流。   
* 缺少自我纠错机制: 模型生成的代码可能包含错误，需要用户手动调试。

##### 3.2.3.2 关键重构前后对比
    图二+图三

#### 3.2.4　提示词工程与GUI美化————sprint3
*   基于更新的架构，完善的提示词工程: 1.增加知识库条目；2.优化提示词，使模型生成的代码更具有稳健性； 3，增加根据知识库条目判断任务是否可以完成的逻辑
*   测试大量的用例，确保模型在不同场景下的表现，根据测试结果不断优化提示词
*   基于Streamlit的用户交互界面: 设计现代UI界面以及各项功能，提供优美的渐变流动动画

#### 3.2.5 模型切换与用户个性化设置————sprint4

*   提供用户切换不同的LLM模型的功能，可以选择普通模型和深度思考模型
*   提供用户界面的主题设置与头像设置

### 3.3 github仓库主分支维护记录

   图四


## 4. 基于最小交付项目（MVP），后续迭代与优化方向

### 4.1 安全性增强 (Security & Sandbox)
*   **当前问题**：目前生成的代码直接在本地 Python 环境运行，虽然有 Prompt 限制，但仍存在潜在风险（如删除文件）。
*   **优化计划**：引入 **Docker 容器技术**，构建隔离的沙箱环境。所有 AI 生成的代码将在一次性容器中运行，执行完毕后立即销毁，确保宿主机的绝对安全。

### 4.2 数据源扩展 (Data Expansion)
*   **当前问题**：仅支持 Tushare 的部分 A 股日线与基本面数据。
*   **优化计划**：
    *   接入 **Binance/CCXT** 接口，支持加密货币分析。
    *   接入 **Yahoo Finance**，支持美股与全球市场数据。
    *   支持用户 **上传 Excel/CSV** 私有数据文件进行混合分析。

### 4.3 多模态交互 (Multimodal Interaction)
*   **当前问题**：仅支持文本输入与静态图表输出。
*   **优化计划**：
    *   **语音输入**：集成 Whisper 模型，支持语音指令（"帮我看看茅台今天的走势"）。
    *   **交互式图表**：将 Matplotlib 静态图升级为 **Plotly/Echarts** 交互式图表，支持缩放、悬停查看数据点。

### 4.4 知识库增强 (RAG Optimization)
*   **当前问题**：依赖简单的 Schema 注入，对复杂金融概念（如 Alpha/Beta 策略）理解依赖大模型自身训练数据。
*   **优化计划**：构建专业的 **向量数据库 (Vector DB)**，存储海量金融研报与量化策略代码库。通过 RAG (检索增强生成) 技术，让 AI 在写代码前能参考最专业的量化实现模版。

### 4.5 加入简单机器学习分析功能
*   **当前问题**：目前仅支持基础的金融分析，不支持使用用户提供的数据进行复杂的机器学习的功能。
*   **优化计划**：
    *   集成 **Scikit-learn** 等经典机器学习库，支持用户训练简单的分类器（如逻辑回归、决策树）。
    *   提供 **模型评估指标**（如准确率、F1 分数、AUC 曲线），帮助用户理解模型性能。


## 5. 本项目对金融科技所能产生的预计影响 (Expected Impact)
### 5.1 降低量化分析门槛 (Democratization)
*   **现状**：量化分析是“少数人的游戏”，需要精通 Python、数学统计和金融业务。
*   **变革**：通过 Code Interpreter，我们将**自然语言**转化为**执行代码**。任何懂业务逻辑的金融从业者（即使不懂编程）也能进行深度的数据挖掘和策略回测。
*   **意义**：赋能普通投资者和业务人员，实现“人人都是数据分析师”的愿景。

### 5.2 提升金融研发效率 (Efficiency)
*   **现状**：传统开发一个简单的“查询+绘图”功能，需要前后端联调、API 对接，耗时数天。
*   **变革**：基于 Agent 的敏捷开发模式，需求即代码。用户提出需求，系统实时生成应用逻辑。
*   **意义**：极大地缩短了金融产品的原型验证周期 (Time-to-Market)，让金融机构能更敏捷地响应市场变化。

### 5.3 验证国产大模型在垂直领域的潜力
*   **现状**：普遍认为国产模型在逻辑推理和代码生成上弱于 GPT-4。
*   **变革**：本项目成功基于 **DeepSeek-V3** 实现了复杂的 Code Interpreter 逻辑，证明了国产大模型在金融垂直领域完全具备落地能力。
*   **意义**：为国内金融机构在“自主可控”的前提下应用 AI 提供了实践范本。


